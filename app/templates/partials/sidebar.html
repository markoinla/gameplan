<!-- 
    Sidebar Management Component
    
    Styled to match minimal, modern aesthetics like ChatGPT's sidebar.
    Simplified layout with flat list structure and subtle hover effects.
    
    Expected variables:
    - project: The project object containing the sprints
    - current_sprint_id (optional): ID of the currently selected sprint
-->

<div class="bg-base-200 min-h-full w-80 text-base-content overflow-y-auto flex flex-col">
    <!-- Sidebar Actions - Top Fixed -->
    <div class="px-4 py-3 border-b border-base-300">
        <div class="flex gap-2">
            <!-- New Sprint Button -->
            <button class="btn btn-ghost btn-sm flex-1 justify-center gap-2 text-base-content hover:bg-base-300 transition-colors duration-200"
                    hx-get="/htmx/sprints/form?project_id={{ project.id }}" 
                    hx-target="#sprint-form-container" 
                    hx-swap="innerHTML">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="1.2em" height="1.2em">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                </svg>
                New Sprint
            </button>
            
            <!-- View Projects Button -->
            <a href="{{ url_for('main.index') }}" class="btn btn-ghost btn-sm flex-1 justify-center gap-2 text-base-content hover:bg-base-300 transition-colors duration-200">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="1.2em" height="1.2em">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z" />
                </svg>
                Projects
            </a>
        </div>
    </div>
    
    <!-- Project Name Heading -->
    <div class="px-4 py-2 border-b border-base-300">
        <h2 class="font-semibold text-lg truncate">{{ project.name }}</h2>
    </div>
    
    <!-- Sprint List - Simplified Flat Structure -->
    <div class="p-1 overflow-y-auto flex-grow">
        {% if project.sprints %}
            {% for sprint in project.sprints|sort(attribute='created_at', reverse=True) %}
                <!-- Sprint Item -->
                <a href="{{ url_for('main.sprint_detail', project_id=project.id, sprint_id=sprint.id) }}" 
                   class="flex flex-col w-full px-3 py-2 rounded-lg mb-1 hover:bg-base-300 transition-colors duration-200 {% if current_sprint_id == sprint.id %}bg-base-300 font-medium{% endif %}">
                    
                    <!-- Main Sprint Info -->
                    <div class="flex items-center gap-2 w-full">
                        <!-- Status Indicator -->
                        <div class="flex-shrink-0 w-2.5 h-2.5 rounded-full {% if sprint.status == 'Active' %}bg-primary{% elif sprint.status == 'Completed' %}bg-success{% else %}bg-secondary{% endif %}"></div>
                        
                        <!-- Sprint Name -->
                        <span class="text-base flex-grow truncate">{{ sprint.name }}</span>
                    </div>
                    
                    <!-- Sprint Stats - Small and Subtle -->
                    <div class="flex gap-3 pl-4 mt-1 text-xs opacity-70">
                        <span>Open:</span>
                        <span><span class="text-primary font-medium">{{ sprint.tasks.count() - sprint.tasks.filter_by(completed=True).count() if sprint.tasks is defined else 0 }}</span> tasks</span>
                        <span><span class="text-warning font-medium">{{ sprint.issues.count() if sprint.issues is defined else 0 }}</span> issues</span>
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <div class="flex flex-col items-center justify-center h-32 text-center opacity-60">
                <p class="text-sm">No sprints yet</p>
                <p class="text-xs mt-2">Create a new sprint to get started</p>
            </div>
        {% endif %}
    </div>
</div>

<!-- Sprint Form Container -->
<div id="sprint-form-container"></div>
